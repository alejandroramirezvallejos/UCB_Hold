<div class="form-container">
  <button class="btn-close" (click)="cerrar()">
    <i class="fas fa-times"></i>
  </button>
  <h2>Editar Usuario</h2>
  <form #form="ngForm" (ngSubmit)="validareditar()" >    

    <div class="form-group">
      <label for="nombre">Nombre</label>
      <input 
        type="text" 
        id="nombre" 
        name="nombre" 
        [(ngModel)]="usuario.nombre"
        required 
        maxlength="30"
        placeholder="Nombre del usuario"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="apellido_paterno">Apellido Paterno</label>
      <input 
        type="text" 
        id="apellido_paterno" 
        name="apellido_paterno" 
        [(ngModel)]="usuario.apellido_paterno"
        required 
        maxlength="30"
        placeholder="Apellido paterno del usuario"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="apellido_materno">Apellido Materno</label>
      <input 
        type="text" 
        id="apellido_materno" 
        name="apellido_materno" 
        [(ngModel)]="usuario.apellido_materno"
        required
        maxlength="30"
        placeholder="Apellido materno del usuario"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="correo">Correo Institucional</label>
      <input 
        type="email" 
        id="correo" 
        name="correo" 
        [(ngModel)]="usuario.correo"
        required 
        maxlength="50"
        pattern="^[a-zA-Z0-9._%+-]+@ucb\.edu\.bo$"
        placeholder="ejemplo@ucb.edu.bo"
        class="form-input"
        #correoInput="ngModel"
      />
      @if(correoInput.errors?.['pattern'] && correoInput.touched) {
        <div class="error-message">
          El correo debe ser de la forma &#64;ucb.edu.bo
          </div>
        }
    </div>

    <div class="form-group">
      <label for="contrasena">Contraseña</label>
      <input 
        type="password" 
        id="contrasena" 
        name="contrasena" 
        [(ngModel)]="contrasena"
        maxlength="30"
        placeholder="Contraseña del usuario"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="telefono">Teléfono</label>
      <input 
        type="tel" 
        id="telefono" 
        name="telefono" 
        [(ngModel)]="usuario.telefono"
        required 
        pattern="[0-9]{8,10}"
        maxlength="10"
        placeholder="79943044"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="rol">Rol</label>
      <select 
        id="rol" 
        name="rol" 
        [(ngModel)]="usuario.rol"
        required
        class="form-input"
      >
        <option value="">Seleccionar rol</option>
        <option value="administrador">Administrador</option>
        <option value="estudiante">Estudiante</option>
      </select>
    </div>

    <div class="form-group">
      <label for="carrera">Carrera</label>
      <select 
        id="carrera" 
        name="carrera" 
        [(ngModel)]="usuario.carrera"
        required 
        placeholder="usuario.carrera"
        class="form-input"
      >
       <option value="" disabled>Selecciona una carrera</option>
       
        @for (item of carreras; track $index) {
          <option [value]="item">{{ item }}</option>
        }

      </select>
    </div>    
    <div class="form-group">
      <label for="nombre_referencia">Nombre de Referencia</label>
      <input 
        type="text" 
        id="nombre_referencia" 
        name="nombre_referencia" 
        maxlength="30"
        [(ngModel)]="usuario.nombre_referencia"
        placeholder="Nombre de referencia"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="telefono_referencia">Teléfono de Referencia</label>
      <input 
        type="tel" 
        id="telefono_referencia" 
        name="telefono_referencia" 
        maxlength="10"
        pattern="[0-9]{8,10}"
        [(ngModel)]="usuario.telefono_referencia"
        placeholder="Teléfono de referencia"
        class="form-input"
      />
    </div>

    <div class="form-group">
      <label for="email_referencia">Email de Referencia</label>
      <input 
        type="email" 
        id="email_referencia" 
        name="email_referencia" 
        maxlength="50"
        pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}"
        [(ngModel)]="usuario.email_referencia"
        placeholder="Email de referencia"
        class="form-input"
      />
    </div>

    <div class="form-submit">
      <button type="submit" class="register-button" [disabled]="!form.valid">
        <span>Confirmar Cambios</span>
      </button>
    </div>
  </form>
</div>


@if(error()){
  <app-mostrarerror
  [error]="error"
  [mensaje]="mensajeerror"
  ></app-mostrarerror>
}

@if(aviso()){
  <app-aviso
  [cerrar]="aviso"
  [mensaje]="mensajeaviso"
  (aceptar)="confirmar()"
  ></app-aviso>
}

@if(exito()){
  <app-aviso-exito
  [exito]="exito"
  [mensaje]="mensajeexito"
  (accion)="cerrar()"
  ></app-aviso-exito>
}