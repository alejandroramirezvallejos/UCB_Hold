<div class="container-search">
  <!-- 1. El buscador -->
  <div
    class="search-input"
    [class.open]="showCategories"
    (focusin)="showCategories = false"
  >
    <img
      class="icon"
      src="/assets/search_line.png"
      alt="Buscar"
      (mouseenter)="hover.search = true"
      (mouseleave)="hover.search = false"
      (click)="submitRequest()"
      [src]="
        hover.search ? '/assets/search_solid.png' : '/assets/search_line.png'
      "
    />

    <textarea
      [(ngModel)]="solicitud"
      placeholder="Buscar..."
      rows="1"
      (keydown.enter)="submitRequest(); $event.preventDefault()"
      (focus)="showCategories = false"
    ></textarea>

    <img
      class="icon"
      src="/assets/microphone_line.png"
      alt="Micrófono"
      (mouseenter)="hover.microfono = true"
      (mouseleave)="hover.microfono = false"
      [src]="
        hover.microfono
          ? '/assets/microphone_solid.png'
          : '/assets/microphone_line.png'
      "
    />

    <img
      class="icon"
      src="/assets/scanner_line.png"
      alt="Escáner"
      (mouseenter)="hover.scanner = true"
      (mouseleave)="hover.scanner = false"
      [src]="
        hover.scanner ? '/assets/scanner_solid.png' : '/assets/scanner_line.png'
      "
    />

    <img
      class="icon category-icon"
      src="/assets/categories_line.png"
      alt="Categorías"
      (click)="toggleCategories()"
      (mouseenter)="hover.categories = true"
      (mouseleave)="hover.categories = false"
      [src]="
        hover.categories
          ? '/assets/categories_solid.png'
          : '/assets/categories_line.png'
      "
    />
  </div>
  @if (showCategories) {
    <div class="categories-panel">
      <div class="categories-list">
        <div class="no-category-item" (click)="selectCategory('')">
          Sin categoría
        </div>
        @for (item of items; track item.nombre) {
          <div class="category-item" (click)="selectCategory(item.nombre)">
            {{ item.nombre }}
          </div>
        }
      </div>
    </div>
  }
</div>

<!-- 3. Lista de resultados fuera del buscador -->
@if (enviar) {
  <app-lista-objetos
    [categoria]="categoria"
    [producto]="solicitud"
  ></app-lista-objetos>
} @else {
  <app-lista-objetos
    [categoria]="categoria"
    [producto]="solicitud"
  ></app-lista-objetos>
}
