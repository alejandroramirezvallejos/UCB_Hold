<!-- iniciar-sesion.component.html -->
<div class="login-container">
  <div class="login-card">
    
    <h2 class="title">Iniciar Sesión</h2>
    
    <form (ngSubmit)="login()" class="login-form">
      <div class="form-group">
        <label for="email">Correo electrónico</label>
        <input 
          type="email" 
          id="email" 
          name="email" 
          [(ngModel)]="email"
          required
          email
          pattern="^[a-zA-Z0-9._%+-]+@ucb\.edu\.bo$"
          placeholder="tu@ucb.edu.bo"
          class="form-input"
          #emailInput="ngModel"
        >
        <div class="error-message">
          @if (emailInput.invalid && (emailInput.dirty || emailInput.touched)) {
            
              @if (emailInput.errors?.['required']) {
                <div>El correo electrónico es requerido</div>
              }
              @if (emailInput.errors?.['pattern']) {
                <div>El correo debe ser de la UCB (&#64;ucb.edu.bo)</div>
              }
          
          }
          @if(incorrecto==true){
                <div>Correo o contraseña incorrectos</div>
              }

         </div>
      </div>

      <div class="form-group">
        <label for="password">Contraseña</label>
        <input 
          type="password" 
          id="password" 
          name="contraseña" 
          [(ngModel)]="contrasena"
          required
          minlength="6"
          placeholder="••••••••"
          class="form-input"
          #passwordInput="ngModel"
        >
          <div class="error-message">
          @if (passwordInput.invalid && (passwordInput.dirty || passwordInput.touched)) {
          
              @if (passwordInput.errors?.['required']) {
                <div>La contraseña es requerida</div>
              }
              @if (passwordInput.errors?.['minlength']) {
                <div>Mínimo 6 caracteres</div>
              }

          
          }
          @if(incorrecto==true){
                <div>Correo o contraseña incorrectos</div>
            }
        </div>
      </div>

      <button type="submit" class="login-button" [disabled]="!email || !contrasena">
        @if (!loading) {
          <span>Ingresar</span>
        } @else {
          <div class="spinner"></div>
        }
      </button>

      <div class="additional-options">
        <p class="register-link">
          ¿No tienes cuenta? <a  (click)="registrarUsuario()" >Regístrate aquí</a>
        </p>

      </div>
    </form>
  </div>
</div>


@if(errorraro()==1){
  <app-mostrarerror
  [error]="errorraro"
  mensaje="Error contraseña o usuario invalido"
  ></app-mostrarerror>
}